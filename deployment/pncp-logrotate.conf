# Configuração de Logrotate para PNCP Jobs
# Arquivo: /etc/logrotate.d/pncp-jobs
#
# Instalação:
#   sudo cp pncp-logrotate.conf /etc/logrotate.d/pncp-jobs
#   sudo chmod 644 /etc/logrotate.d/pncp-jobs
#
# Testar configuração:
#   sudo logrotate -d /etc/logrotate.d/pncp-jobs
#   sudo logrotate -f /etc/logrotate.d/pncp-jobs

/var/log/pncp-jobs/*.log {
    # Roda diariamente
    daily
    
    # Mantém logs dos últimos 30 dias
    rotate 30
    
    # Comprime logs antigos com gzip
    compress
    delaycompress
    
    # Não gera erro se o arquivo não existir
    missingok
    
    # Não roda rotação se o arquivo estiver vazio
    notifempty
    
    # Cria novos arquivos de log com estas permissões
    create 0640 pncp pncp
    
    # Usa a data no nome do arquivo rotacionado
    dateext
    dateformat -%Y%m%d
    
    # Executa após a rotação (opcional - reinicia serviços se necessário)
    # postrotate
    #     systemctl reload rsyslog > /dev/null 2>&1 || true
    # endscript
}
